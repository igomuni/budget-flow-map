# 予算スケールの可視化限界

## 分析日
2026-01-04

## 概要

日本政府予算データのスケール感を、地図や4K画面との比較で検証する。
この分析により、「なぜ全ノード展開が不可能か」を直感的に理解できる。

## 予算データのスケール

| 項目 | 金額 |
|------|------|
| 最大（厚労省） | 93兆円 |
| 中央値 | 1,357万円 |
| 最小 | 20円 |
| **レンジ** | **約4.65 × 10¹² 倍** |

## 4K画面で例える

### 全予算（150兆円）を4K画面（2160px高さ）に収めた場合

**1ピクセル = 約694億円**

| 金額 | 画面上のサイズ | 見え方 |
|------|--------------|--------|
| 厚労省（93兆円） | 1,339px | 画面の62%（明確に見える） |
| 1兆円 | 14px | 小さいが見える |
| 1000億円 | 1.4px | ギリギリ1ピクセル |
| 100億円 | 0.14px | **見えない** |
| 中央値（1357万円） | 0.0002px | **絶対に見えない** |
| 100万円 | 0.00001px | 見えない |
| 最小（20円） | 0.0000000003px | **原子より小さい** |

### 中央値を見るには

**中央値（1357万円）を1ピクセルで表示するには約5,117倍ズームが必要**

| 目標 | 必要ズーム倍率 |
|------|---------------|
| 100億円を1pxで見る | 約7倍 |
| 10億円を1pxで見る | 約70倍 |
| 1億円を1pxで見る | 約700倍 |
| 中央値（1357万円）を1pxで見る | **約5,117倍** |
| 最小（20円）を1pxで見る | **約35億倍** |

## Google Mapsのスケール参考

### 実測値（画面上の表示）

| 表示レベル | スケールバー表示 | 画面上の長さ |
|-----------|-----------------|-------------|
| 世界地図レベル | 1000km | 約2cm |
| 最大ズーム（Google本部周辺） | 5m | 約3.5cm |

**スケールバーの長さの差**: 約1.75倍（2cm → 3.5cm）
**実際の距離の差**: 20万倍（1000km → 5m）

つまりGoogle Mapsは、**スケールバーの見た目をほぼ一定に保ちながら**、
実際には20万倍のスケール変化を実現している。

### 地図のズームレベル（技術仕様）

[OpenStreetMap Wiki](https://wiki.openstreetmap.org/wiki/Zoom_levels)より:

| zoom | 倍率 | m/pixel | 縮尺 | 見えるもの |
|------|------|---------|------|-----------|
| 0 | 1倍 | 156,543m | 1:500M | 地球全体 |
| 3 | 8倍 | 19,568m | 1:70M | 大陸・大国 |
| 5 | 32倍 | 4,892m | 1:15M | 国 |
| 7 | 128倍 | 1,223m | 1:4M | 小国・州 |
| 8 | 256倍 | 611m | 1:2M | 都道府県 |
| 10 | 1,024倍 | 153m | 1:500K | 市区町村 |
| 13 | 8,192倍 | 19m | 1:70K | 村・郊外 |
| 15 | 32,768倍 | 4.8m | 1:15K | 道路 |
| 17 | 131,072倍 | 1.2m | 1:4K | 建物・住所 |
| 19 | 524,288倍 | 0.3m | 1:1K | 交差点詳細 |
| 20 | 1,048,576倍 | 0.15m | 1:500 | 中規模建物 |

**注**: m/pixel は赤道上の値。緯度により cos(緯度) を乗算する必要がある。

### スケール計算式

```
m/pixel = 156,543.03392 × cos(緯度) / 2^zoom
```

東京（北緯35.7度）の場合:
- zoom 0: 156,543 × cos(35.7°) ≈ 127,000 m/pixel
- zoom 20: 0.15 × cos(35.7°) ≈ 0.12 m/pixel

### 予算を地図に例えると

**予算のレンジ（10¹²倍）は、地図の約42 zoom分に相当**

通常の地図は zoom 0→20（約100万倍）で地球から人間まで見える。
予算データを同じ精度で見るには zoom 0→42 が必要（実用的に不可能）。

| 予算 | 地図換算 | スケール感 |
|------|----------|-----------|
| **93兆円（厚労省）** | zoom 0 | 地球全体 |
| 1兆円 | zoom ≈7 | 国〜地方 |
| 100億円 | zoom ≈14 | 町〜建物 |
| **中央値（1357万円）** | zoom ≈23 | 建物より詳細（存在しない） |
| **最小（20円）** | zoom ≈43 | 分子レベル（存在しない） |

### 現在の設定を地図で例えると

| budget-flow-map | 地図相当 | 見えるもの |
|-----------------|---------|-----------|
| zoom=-4（最小） | 地球全体の0.06倍 | 何も見えない |
| zoom=0（初期） | 地球全体 | 大陸のみ |
| zoom=6（現maxZoom） | 都道府県〜市 | 都市の輪郭 |
| zoom=8（推奨） | 市区町村 | 建物の配置 |
| zoom=9（候補） | 町・村 | 個別の建物 |

## 本質的な問題

### なぜ全ノード展開は不可能か

1. **予算レンジは地図の100万倍広い**
   - 地図: zoom 0→20 で 10⁶倍（地球→人間）
   - 予算: 10¹²倍（厚労省→20円）

2. **中央値ですら「存在しない」ズームレベル**
   - 地図で zoom 23 は通常存在しない
   - 予算の中央値はそのレベルの詳細さに相当

3. **物理的に不可能な精度**
   - 最小（20円）を見るには35億倍ズームが必要
   - これは分子レベルの精度に相当

## 設計上の結論

### 受け入れるべきトレードオフ

| 得られるもの | 失うもの |
|------------|---------|
| 93兆円から数億円まで破綻なく描画 | 数億円未満の金額の視覚的区別 |
| 全体構造の俯瞰 | 個別支出の詳細表示 |
| 滑らかなズーム体験 | 全ノードの個別可視化 |

### 推奨設定

| 設定 | 値 | 理由 |
|------|-----|------|
| maxZoom | 8〜9 | 分布の中央付近（1000万〜1億円）までカバー |
| 「その他」ノード | 常に存在 | 数万件のノードを集約して表示 |
| InfoPanel | 詳細表示用 | 個別支出はテーブルで確認 |

## 比喩的まとめ

```
予算の可視化は、4K画面で「原子」を見ようとするようなもの。

・厚労省（93兆円）= 画面全体
・中央値（1357万円）= 0.0002ピクセル（見えない）
・最小（20円）= 0.0000000003ピクセル（原子より小さい）

全ノードを展開するには35億倍のズームが必要。
これは「地球を見ながら原子を見る」のと同じ無理難題。

現実的な解決策は:
1. 大きな支出はマップで可視化
2. 小さな支出はInfoPanelのテーブルで補完
3. 「その他」ノードで集約された支出も探索可能に
```

## 関連ファイル

- `docs/20260104_recipient-distribution-analysis.md` - 金額分布分析
- `docs/20251230_0030_height-scale-analysis.md` - 高さスケール分析
- `src/components/BudgetFlowMap.tsx` - minZoom/maxZoom定義
